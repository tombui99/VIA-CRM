<h2 [class]="hlmH2">Leads</h2>
@if(leadsQuery.error()) {
<div class="flex h-8 w-full items-center">
  <div class="text-destructive text-sm">Error loading leads: {{ leadsQuery.error()?.message }}</div>
</div>
}

<!-- Mutation errors -->
@if(createLeadMutation.error() || updateLeadMutation.error()) {
<div class="flex h-8 w-full items-center">
  <div class="text-destructive text-sm">Error creating/updating leads</div>
</div>
}

<!-- Content -->
@if (leadsQuery.isLoading()) {
<div class="flex h-48 w-full items-center justify-center">
  <div class="text-muted-foreground text-sm">Loading...</div>
</div>
} @else if(hasResults()) {
<div class="mb-4 mt-4 flex items-center">
  <button hlmBtn (click)="openLeadFormSheet()">Add new lead</button>
  <lead-sheet
    #leadSheetForm
    [lead]="selectedLead()"
    (submit)="handleLeadSubmit($event)"
  ></lead-sheet>
</div>
<custom-datatable
  [data]="leadsQuery.data()"
  [columns]="columns()"
  [options]="{ enableResizing: true, minSize: 60, maxSize: 800, tableId: 'leads-table' }"
>
</custom-datatable>
<ng-template #firstNameCell let-context>
  <span
    class="underline capitalize cursor-pointer"
    role="button"
    tabindex="0"
    (click)="openLeadFormSheet(context.row.original)"
    >{{ context.getValue() }}</span
  >
</ng-template>
}
